---
/**
 * Architecture Section - 3-Layer Concentric Architecture
 */
import ImagePreview from './ImagePreview.astro';

const layers = [
  {
    name: 'Core',
    description: 'Foundation layer with configuration, exceptions, and logging',
    components: ['Config', 'Exceptions', 'Logging', 'Validation'],
    color: 'from-blue-600 to-blue-400',
  },
  {
    name: 'Infrastructure',
    description: 'Automation, bridges, and execution engines',
    components: ['WorkflowEngine', 'ExecutionEngine', 'LifecycleManager', 'Bridges'],
    color: 'from-purple-600 to-pink-500',
  },
  {
    name: 'Intelligence',
    description: 'Learning, monitoring, reasoning, and collaboration',
    components: ['Learner', 'Monitor', 'Reasoner', 'Collaborator'],
    color: 'from-cyan-500 to-green-500',
  },
  {
    name: 'Orchestration',
    description: 'Agents, models, workflows, and coordination',
    components: ['Agent', 'AgentRegistry', 'ModelClient', 'Workflow', 'WorkflowBuilder'],
    color: 'from-yellow-500 to-orange-500',
  },
  {
    name: 'Plugins',
    description: 'Extensibility through plugin system',
    components: ['Plugin', 'PluginRegistry', 'Custom Extensions'],
    color: 'from-pink-500 to-red-500',
  },
];

const intelligenceGroups = [
  {
    name: 'Core Components',
    agents: ['Config Management', 'Exception Handling', 'Logging System', 'Validation'],
    color: 'text-blue-400',
  },
  {
    name: 'Infrastructure',
    agents: ['Workflow Engine', 'Execution Engine', 'Lifecycle Manager', 'Bridge System'],
    color: 'text-purple-400',
  },
  {
    name: 'Intelligence Layer',
    agents: ['Learner', 'Monitor', 'Reasoner', 'Collaborator'],
    color: 'text-green-400',
  },
  {
    name: 'Orchestration',
    agents: ['Agent System', 'Agent Registry', 'Model Client', 'Workflow Builder'],
    color: 'text-yellow-400',
  },
  {
    name: 'Plugin System',
    agents: ['Plugin Interface', 'Plugin Registry', 'Extension Points', 'Custom Plugins'],
    color: 'text-pink-400',
  },
  {
    name: 'CLI Tools (Optional)',
    agents: ['Init Command', 'Run Command', 'Config Command', 'Plugin Command'],
    color: 'text-cyan-400',
  },
];
---

<section id="architecture" class="section bg-secondary/30">
  <div class="container">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold mb-4">
        Modular SDK Architecture
      </h2>
      <p class="text-muted-foreground max-w-2xl mx-auto">
        Clean separation of concerns with a well-defined public API and extensible plugin system
      </p>
    </div>

    <!-- Architecture Layers -->
    <div class="max-w-4xl mx-auto space-y-4 mb-12">
      {layers.map((layer, index) => (
        <div 
          class="card group relative overflow-hidden"
          style={`animation-delay: ${index * 0.1}s`}
        >
          <!-- Gradient bar -->
          <div class={`absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b ${layer.color}`}></div>
          
          <div class="pl-6">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
              <div>
                <h3 class="text-lg font-semibold mb-1">{layer.name}</h3>
                <p class="text-sm text-muted-foreground">{layer.description}</p>
              </div>
              <div class="flex flex-wrap gap-2">
                {layer.components.map((component) => (
                  <span class="px-2 py-1 bg-background rounded text-xs font-mono text-muted-foreground border border-border">
                    {component}
                  </span>
                ))}
              </div>
            </div>
          </div>
        </div>
      ))}
    </div>

    <!-- SDK Components -->
    <div class="max-w-4xl mx-auto mb-12">
      <div class="card border-primary/30 bg-primary/5">
        <div class="text-center mb-6">
          <span class="text-3xl mb-2 block animate-pulse">ðŸ”§</span>
          <h3 class="text-xl font-semibold mb-2">SDK Components</h3>
          <p class="text-sm text-muted-foreground">
            Comprehensive framework with clean public API and extensible architecture
          </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {intelligenceGroups.map((group) => (
            <div class="p-4 bg-background/50 rounded-lg border border-border/50">
              <h4 class={`text-sm font-semibold mb-2 ${group.color}`}>{group.name}</h4>
              <div class="space-y-1">
                {group.agents.map((agent) => (
                  <div class="text-xs text-muted-foreground font-mono">â€¢ {agent}</div>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>

    <!-- Diagrams Section -->
    <div class="max-w-4xl mx-auto">
      <div class="text-center mb-8">
        <h3 class="text-2xl font-bold mb-2">Architecture Diagrams</h3>
        <p class="text-muted-foreground">
          Visual representations of system flows and interactions
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Diagram Cards -->
        <a 
          href="https://github.com/truongnat/agentic-sdlc/blob/main/docs/diagrams/architecture_3_layers.png" 
          data-diagram-preview
          data-image-src="/diagrams/architecture_3_layers.png"
          data-title="3-Layer Architecture"
          data-description="Core â†’ Intelligence â†’ Infrastructure"
          class="card group hover:border-primary/50 transition-all overflow-hidden cursor-pointer"
        >
          <div class="aspect-video bg-background rounded-lg mb-4 overflow-hidden border border-border/50">
            <img 
              src="/diagrams/architecture_3_layers.png" 
              alt="3-Layer Architecture Diagram"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            />
          </div>
          <h4 class="font-semibold mb-1 group-hover:text-primary transition-colors">3-Layer Architecture</h4>
          <p class="text-sm text-muted-foreground">Core â†’ Intelligence â†’ Infrastructure</p>
        </a>

        <a 
          href="https://github.com/truongnat/agentic-sdlc/blob/main/docs/diagrams/orchestrator_workflow_flow.png" 
          data-diagram-preview
          data-image-src="/diagrams/orchestrator_workflow_flow.png"
          data-title="Orchestrator Workflow"
          data-description="11 phases with HITL gates"
          class="card group hover:border-primary/50 transition-all overflow-hidden cursor-pointer"
        >
          <div class="aspect-video bg-background rounded-lg mb-4 overflow-hidden border border-border/50">
            <img 
              src="/diagrams/orchestrator_workflow_flow.png" 
              alt="Orchestrator Workflow Diagram"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            />
          </div>
          <h4 class="font-semibold mb-1 group-hover:text-primary transition-colors">Orchestrator Workflow</h4>
          <p class="text-sm text-muted-foreground">11 phases with HITL gates</p>
        </a>

        <a 
          href="https://github.com/truongnat/agentic-sdlc/blob/main/docs/diagrams/brain_intelligence_subagents.png" 
          data-diagram-preview
          data-image-src="/diagrams/brain_intelligence_subagents.png"
          data-title="Intelligence Network"
          data-description="21 sub-agents interaction"
          class="card group hover:border-primary/50 transition-all overflow-hidden cursor-pointer"
        >
          <div class="aspect-video bg-background rounded-lg mb-4 overflow-hidden border border-border/50">
            <img 
              src="/diagrams/brain_intelligence_subagents.png" 
              alt="Brain Intelligence Sub-Agents Network Diagram"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            />
          </div>
          <h4 class="font-semibold mb-1 group-hover:text-primary transition-colors">Intelligence Network</h4>
          <p class="text-sm text-muted-foreground">21 sub-agents interaction</p>
        </a>

        <a 
          href="https://github.com/truongnat/agentic-sdlc/blob/main/docs/diagrams/brain_learning_loop.png" 
          data-diagram-preview
          data-image-src="/diagrams/brain_learning_loop.png"
          data-title="Learning Loop"
          data-description="8-step compound learning"
          class="card group hover:border-primary/50 transition-all overflow-hidden cursor-pointer"
        >
          <div class="aspect-video bg-background rounded-lg mb-4 overflow-hidden border border-border/50">
            <img 
              src="/diagrams/brain_learning_loop.png" 
              alt="Brain Learning Loop Diagram"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            />
          </div>
          <h4 class="font-semibold mb-1 group-hover:text-primary transition-colors">Learning Loop</h4>
          <p class="text-sm text-muted-foreground">8-step compound learning</p>
        </a>
      </div>

      <div class="text-center mt-8">
        <a 
          href="https://github.com/truongnat/agentic-sdlc#-architecture--flows" 
          target="_blank"
          class="btn-primary inline-flex items-center gap-2"
        >
          View All Diagrams
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </a>
      </div>
    </div>
  </div>

  <!-- Image Preview Modal -->
  <ImagePreview />
</section>
