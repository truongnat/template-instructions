{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "API Model Management Configuration Schema",
  "description": "Configuration schema for API-based model selection and rate limit management",
  "type": "object",
  "required": ["models"],
  "properties": {
    "models": {
      "type": "array",
      "description": "List of available AI models",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": [
          "id",
          "provider",
          "name",
          "capabilities",
          "cost_per_1k_input_tokens",
          "cost_per_1k_output_tokens",
          "rate_limits",
          "context_window",
          "average_response_time_ms"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the model",
            "minLength": 1
          },
          "provider": {
            "type": "string",
            "description": "Provider name",
            "enum": ["openai", "anthropic", "google", "ollama"]
          },
          "name": {
            "type": "string",
            "description": "Human-readable model name",
            "minLength": 1
          },
          "capabilities": {
            "type": "array",
            "description": "List of model capabilities",
            "minItems": 1,
            "items": {
              "type": "string",
              "enum": ["text-generation", "code-generation", "analysis", "reasoning"]
            }
          },
          "cost_per_1k_input_tokens": {
            "type": "number",
            "description": "Cost per 1000 input tokens in USD",
            "minimum": 0
          },
          "cost_per_1k_output_tokens": {
            "type": "number",
            "description": "Cost per 1000 output tokens in USD",
            "minimum": 0
          },
          "rate_limits": {
            "type": "object",
            "required": ["requests_per_minute", "tokens_per_minute"],
            "properties": {
              "requests_per_minute": {
                "type": "integer",
                "description": "Maximum requests per minute",
                "minimum": 1
              },
              "tokens_per_minute": {
                "type": "integer",
                "description": "Maximum tokens per minute",
                "minimum": 1
              }
            }
          },
          "context_window": {
            "type": "integer",
            "description": "Maximum context window size in tokens",
            "minimum": 1
          },
          "average_response_time_ms": {
            "type": "number",
            "description": "Average response time in milliseconds",
            "minimum": 0
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether the model is enabled",
            "default": true
          }
        }
      }
    },
    "health_check": {
      "type": "object",
      "description": "Health check configuration",
      "properties": {
        "interval_seconds": {
          "type": "integer",
          "description": "Interval between health checks in seconds",
          "minimum": 10,
          "default": 60
        },
        "timeout_seconds": {
          "type": "integer",
          "description": "Health check timeout in seconds",
          "minimum": 1,
          "default": 10
        },
        "consecutive_failures_threshold": {
          "type": "integer",
          "description": "Number of consecutive failures before marking unavailable",
          "minimum": 1,
          "default": 3
        }
      }
    },
    "rate_limiting": {
      "type": "object",
      "description": "Rate limiting configuration",
      "properties": {
        "threshold_percent": {
          "type": "number",
          "description": "Percentage of rate limit to trigger rate-limited status",
          "minimum": 0,
          "maximum": 100,
          "default": 90
        },
        "window_seconds": {
          "type": "integer",
          "description": "Rate limit window in seconds",
          "minimum": 1,
          "default": 60
        }
      }
    },
    "caching": {
      "type": "object",
      "description": "Response caching configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Whether caching is enabled",
          "default": true
        },
        "max_size_mb": {
          "type": "integer",
          "description": "Maximum cache size in megabytes",
          "minimum": 1,
          "default": 1000
        },
        "default_ttl_seconds": {
          "type": "integer",
          "description": "Default time-to-live for cached responses in seconds",
          "minimum": 1,
          "default": 3600
        }
      }
    },
    "budget": {
      "type": "object",
      "description": "Budget configuration",
      "properties": {
        "daily_limit": {
          "type": "number",
          "description": "Daily spending limit in USD",
          "minimum": 0,
          "default": 100.0
        },
        "alert_threshold_percent": {
          "type": "number",
          "description": "Percentage of budget to trigger alert",
          "minimum": 0,
          "maximum": 100,
          "default": 80
        }
      }
    },
    "quality_evaluation": {
      "type": "object",
      "description": "Response quality evaluation configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Whether quality evaluation is enabled",
          "default": true
        },
        "threshold": {
          "type": "number",
          "description": "Minimum acceptable quality score",
          "minimum": 0,
          "maximum": 1,
          "default": 0.7
        },
        "evaluation_window": {
          "type": "integer",
          "description": "Number of recent requests to consider for quality trends",
          "minimum": 1,
          "default": 10
        }
      }
    },
    "failover": {
      "type": "object",
      "description": "Failover configuration",
      "properties": {
        "max_retries": {
          "type": "integer",
          "description": "Maximum retry attempts",
          "minimum": 0,
          "default": 3
        },
        "base_backoff_seconds": {
          "type": "integer",
          "description": "Base backoff delay in seconds",
          "minimum": 1,
          "default": 2
        },
        "alert_threshold": {
          "type": "integer",
          "description": "Number of failovers to trigger alert",
          "minimum": 1,
          "default": 3
        },
        "alert_window_hours": {
          "type": "integer",
          "description": "Time window for failover alert in hours",
          "minimum": 1,
          "default": 1
        }
      }
    },
    "concurrency": {
      "type": "object",
      "description": "Concurrency configuration",
      "properties": {
        "max_concurrent_requests_per_provider": {
          "type": "integer",
          "description": "Maximum concurrent requests per provider",
          "minimum": 1,
          "default": 10
        }
      }
    }
  }
}
