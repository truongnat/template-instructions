# Task
Upgrade the current internal session-based auth to a secure OAuth2/OIDC flow using FastAPI. Ensure compatibility with existing user database and follow OWASP Top 10 security guidelines.

## Domain: backend

## Approach â€” Think Step by Step
Before implementing, reason through the following:
1. **Understand**: What exactly is being asked?
2. **Research**: What existing patterns or solutions apply?
3. **Design**: What architecture and components are needed?
4. **Plan**: What is the implementation order?
5. **Implement**: Write the code following the plan.
6. **Verify**: How to validate correctness?

## Output
Show your reasoning process, then provide the implementation.